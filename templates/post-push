#!/bin/bash
# Post-push hook to automatically monitor CI/CD pipelines
# This hook runs after every git push

echo "🚀 Post-push hook triggered - Monitoring CI/CD pipelines..."

# Get the current directory (repository root)
REPO_ROOT="$(git rev-parse --show-toplevel)"
cd "$REPO_ROOT"

# Check if pipeline monitor exists
if [ -f "pipeline_monitor.py" ]; then
    echo "🔍 Starting pipeline monitoring..."
    
    # Run the pipeline monitor
    python pipeline_monitor.py
    
    # Check the exit code
    if [ $? -eq 0 ]; then
        echo "✅ Pipeline monitoring completed successfully"
    else
        echo "❌ Pipeline monitoring failed or pipelines failed"
        echo "💡 Check the output above for details"
    fi
else
    echo "⚠️  Pipeline monitor not found. Skipping monitoring."
fi

echo "🏁 Post-push hook completed"
